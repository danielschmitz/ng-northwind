<h3>Login</h3>

<form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
  <app-loading [loading]="loading">
    <mat-form-field appearance="fill">
      <mat-label>Email</mat-label>
      <input
        matInput
        id="email"
        type="email"
        formControlName="email"
        placeholder="Enter your email"
      />
      <mat-error
        *ngIf="
          loginForm.get('email')?.invalid && loginForm.get('email')?.touched
        "
      >
        @if (loginForm.get('email')?.errors?.['required']) { Email is required.
        } @if (loginForm.get('email')?.errors?.['email']) { Invalid email
        format. }
      </mat-error>
    </mat-form-field>
    <mat-form-field appearance="fill">
      <mat-label>Password</mat-label>
      <input
        matInput
        id="password"
        type="password"
        formControlName="password"
        placeholder="Enter your password"
      />
      <mat-error
        *ngIf="
          loginForm.get('password')?.invalid &&
          loginForm.get('password')?.touched
        "
      >
        Password is required.
      </mat-error>
    </mat-form-field>
    <mat-slide-toggle formControlName="createAccount"
      >Create Account</mat-slide-toggle
    >
    @if (loginForm.get('createAccount')?.value) {
    <mat-form-field appearance="fill">
      <mat-label>Name</mat-label>
      <input
        matInput
        id="displayName"
        formControlName="displayName"
        placeholder="Enter your name"
      />
      <mat-error
        *ngIf="
          loginForm.get('displayName')?.hasError('required') &&
          loginForm.get('displayName')?.touched
        "
      >
        Name is required when creating an account.
      </mat-error>
    </mat-form-field>
    }
  </app-loading>

  <div class="action-bar">
    <button
      mat-flat-button
      type="submit"
      [disabled]="loginForm.invalid || loading"
    >
      {{ loading ? "Wait..." : "Submit" }}
    </button>
  </div>
</form>
